% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/si_payandeh1974.R
\name{si_payandeh1974}
\alias{si_payandeh1974}
\title{Payandeh (1974) site index model}
\usage{
si_payandeh1974(age, height = NULL, si = NULL, species)
}
\arguments{
\item{age}{Numeric vector. Breast-height age (years).}

\item{height}{Optional numeric vector. Total tree height (m). If provided, `si` is predicted.}

\item{si}{Optional numeric vector. Site index (m, base age 50 years at breast height). If provided, `height` is predicted.}

\item{species}{Character vector of species codes (e.g., `"ABIE.BAL"`).}
}
\value{
A tibble with columns:
\describe{
  \item{height}{Predicted height (m), returned when input `si` is provided.}
  \item{si}{Predicted site index (m), returned when input `height` is provided.}
}
}
\description{
Unified, vectorized implementation of the Payandeh (1974) nonlinear site
index equations.
}
\details{
\strong{Index-age note:} this model uses species-specific site-index base
ages (not a single common base age for all species). In this implementation:
50 years for \code{ABIE.BAL, PICE.GLA, PICE.RUB, PINU.MON};
80 years for \code{PINU.CON}; and
100 years for \code{PICE.SIT, PINU.PON, PSEU.MEN, TSUG.HET}.

Provide exactly one of `height` or `si`:
\itemize{
  \item If `height` is provided, the function predicts `si`.
  \item If `si` is provided, the function predicts `height`.
}

Inputs/outputs are metric; the original equations are in imperial units, so
the function converts internally.
}
\examples{
# Predict site index from age + height
si_payandeh1974(
  age = c(20, 40, 60),
  height = c(8, 16, 28),
  species = c("ABIE.BAL", "PICE.GLA", "PSEU.MEN")
)

# Predict height from age + site index
si_payandeh1974(
  age = c(20, 40, 60),
  si = c(12, 18, 24),
  species = c("ABIE.BAL", "PICE.GLA", "PSEU.MEN")
)

# Works with the pipe operator: predict site index from age + height
trees_h <- tibble::tibble(
  species = c("ABIE.BAL", "PICE.GLA", "PSEU.MEN"),
  age = c(20, 40, 60),
  height = c(8, 16, 28)
)

trees_h |>
  dplyr::mutate(
    si_pred = si_payandeh1974(
      age = age,
      height = height,
      species = species
    )
  ) |>
  tidyr::unnest(si_pred)

# With pipe: predict height from age + site index
trees_si <- tibble::tibble(
  species = c("ABIE.BAL", "PICE.GLA", "PSEU.MEN"),
  age = c(20, 40, 60),
  si = c(12, 18, 24)
)

trees_si |>
  dplyr::mutate(
    height_pred = si_payandeh1974(
      age = age,
      si = si,
      species = species
    )
  ) |>
  tidyr::unnest(height_pred)

}
\references{
Payandeh, B. (1974). Nonlinear site index equations for several major
Canadian timber species. \emph{The Forestry Chronicle}, 50(5), 194-196.
}
