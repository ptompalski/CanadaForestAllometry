% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/si_kerbowling1991.R
\name{si_kerbowling1991}
\alias{si_kerbowling1991}
\title{Ker and Bowling (1991) site index model}
\usage{
si_kerbowling1991(age, height = NULL, si = NULL, species)
}
\arguments{
\item{age}{Numeric vector. Breast-height age (years).}

\item{height}{Optional numeric vector. Total tree height (m). If provided,
`si` is predicted.}

\item{si}{Optional numeric vector. Site index (m, base age 50 years at
breast height). If provided, `height` is predicted.}

\item{species}{Character vector of species codes (e.g., `"ABIE.BAL"`).}
}
\value{
A tibble with columns:
\describe{
  \item{height}{Predicted height (m), returned when input `si` is provided.}
  \item{si}{Predicted site index (m), returned when input `height` is provided.}
}
}
\description{
Unified, vectorized implementation of the Ker and Bowling (1991)
polymorphic site-index equation (model 1, conditioned form; eq. 9) for New
Brunswick softwoods.
}
\details{
Provide exactly one of `height` or `si`:
\itemize{
  \item If `height` is provided, the function predicts `si`.
  \item If `si` is provided, the function predicts `height`.
}

This implementation uses the conditioned equation at index age 50 years
(breast-height age), so predicted height equals site index at `age = 50`.

Predicting `height` from `si` is direct. Predicting `si` from `height` is
implicit (site index also appears in the exponent term), so there is no
closed-form algebraic inverse. For that mode, this implementation solves for
`si` numerically with `stats::uniroot()`.

Inputs/outputs are metric (m), matching the source model.
}
\examples{
# Predict site index from age + height
si_kerbowling1991(
  age = c(25, 40, 60),
  height = c(8, 14, 20),
  species = c("ABIE.BAL", "PICE.MAR", "PINU.BAN")
)

# Predict height from age + site index
si_kerbowling1991(
  age = c(25, 40, 60),
  si = c(11, 13, 16),
  species = c("ABIE.BAL", "PICE.MAR", "PINU.BAN")
)

# Works with the pipe operator: predict site index from age + height
trees_h <- tibble::tibble(
  species = c("ABIE.BAL", "PICE.MAR", "PINU.BAN"),
  age = c(25, 40, 60),
  height = c(8, 14, 20)
)

trees_h |>
  dplyr::mutate(
    si_pred = si_kerbowling1991(
      age = age,
      height = height,
      species = species
    )
  ) |>
  tidyr::unnest(si_pred)

# With pipe: predict height from age + site index
trees_si <- tibble::tibble(
  species = c("ABIE.BAL", "PICE.MAR", "PINU.BAN"),
  age = c(25, 40, 60),
  si = c(11, 13, 16)
)

trees_si |>
  dplyr::mutate(
    height_pred = si_kerbowling1991(
      age = age,
      si = si,
      species = species
    )
  ) |>
  tidyr::unnest(height_pred)

}
\references{
Ker, M. F., & Bowling, C. (1991). Polymorphic site index equations for four
New Brunswick softwood species. \emph{Canadian Journal of Forest Research},
21(5), 728-732.
}
