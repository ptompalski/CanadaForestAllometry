% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/si_scottvoorhis1986.R
\name{si_scottvoorhis1986}
\alias{si_scottvoorhis1986}
\title{Scott and Voorhis (1986) site index model}
\usage{
si_scottvoorhis1986(
  age,
  height = NULL,
  si = NULL,
  species,
  convert_to_total_age = FALSE
)
}
\arguments{
\item{age}{Numeric vector. Breast-height age (years), not total age.}

\item{height}{Optional numeric vector. Total tree height (m). If provided,
`si` is predicted.}

\item{si}{Optional numeric vector. Site index (m, base age 50 years at
breast height). If provided, `height` is predicted.}

\item{species}{Character vector of species codes (e.g., `"ABIE.BAL"`).}

\item{convert_to_total_age}{Logical scalar. If `TRUE`, converts
breast-height age to total age internally using the Scott and Voorhis
age-to-breast-height relation (source-consistent behavior). If `FALSE`
(default), uses `age` directly in the height equation.}
}
\value{
A tibble with columns:
\describe{
  \item{height}{Predicted height (m), returned when input `si` is provided.}
  \item{si}{Predicted site index (m), returned when input `height` is provided.}
}
}
\description{
Unified, vectorized implementation of the Scott and Voorhis (1986)
polymorphic site-index equation for northeastern species.
}
\details{
\strong{Age definition note:} `age` is breast-height age (years). The model
internally computes age-to-breast-height and uses total age in the height
equation.

\strong{Base-age note:} site index in this model is referenced to base age
50 years, but the fitted equations were not constrained to pass exactly
through SI at base age for every species.

Provide exactly one of `height` or `si`:
\itemize{
  \item If `height` is provided, the function predicts `si`.
  \item If `si` is provided, the function predicts `height`.
}

In this model, total age is the sum of breast-height age and age-to-breast-height.
Age-to-breast-height is itself a function of site index, so predicting `si` from
`height` is implicit and solved numerically with `stats::uniroot()`.

Inputs/outputs are metric; the original equations are in imperial units, so
the function converts internally.
}
\examples{
# Predict site index from age + height
si_scottvoorhis1986(
  age = c(25, 40, 60),
  height = c(8, 14, 20),
  species = c("ABIE.BAL", "PICE.MAR", "PINU.BAN")
)

# Predict height from age + site index
si_scottvoorhis1986(
  age = c(25, 40, 60),
  si = c(11, 13, 16),
  species = c("ABIE.BAL", "PICE.MAR", "PINU.BAN"),
  convert_to_total_age = TRUE
)

}
\references{
Scott, C. T., & Voorhis, N. G. (1986). Northeastern forest survey site
index equations and site productivity classes. \emph{Northern Journal of
Applied Forestry}, 3(4), 144-148.
}
