% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/si_lundgrendolid1970.R
\name{si_lundgrendolid1970}
\alias{si_lundgrendolid1970}
\title{Lundgren and Dolid (1970) site index model}
\usage{
si_lundgrendolid1970(
  age,
  height = NULL,
  si = NULL,
  species,
  model = c("exponential_monomolecular", "monomolecular")
)
}
\arguments{
\item{age}{Numeric vector. Breast-height age (years).}

\item{height}{Optional numeric vector. Total tree height (m). If provided, `si` is predicted.}

\item{si}{Optional numeric vector. Site index (m, base age 50 years at breast height). If provided, `height` is predicted.}

\item{species}{Character vector of species codes (e.g., `"PICE.MAR"`).}

\item{model}{Character scalar. One of `"exponential_monomolecular"` or `"monomolecular"`.}
}
\value{
A tibble with columns:
\describe{
  \item{height}{Predicted height (m), returned when input `si` is provided.}
  \item{si}{Predicted site index (m), returned when input `height` is provided.}
}
}
\description{
Unified, vectorized implementation of the Lundgren and Dolid (1970) site
index equations for Lake States species.
}
\details{
Two model forms are available:
\itemize{
  \item \code{"exponential_monomolecular"} (default; preferred in the paper)
  \item \code{"monomolecular"}
}

Provide exactly one of `height` or `si`:
\itemize{
  \item If `height` is provided, the function predicts `si`.
  \item If `si` is provided, the function predicts `height`.
}

Inputs/outputs are metric; the original equations are in imperial units, so
the function converts internally.
}
\examples{
# Predict site index from age + height (default model: exponential_monomolecular)
si_lundgrendolid1970(
  age = c(20, 40, 60),
  height = c(8, 16, 24),
  species = c("PICE.MAR", "PINU.BAN", "BETU.PAP")
)

# Predict height from age + site index, using the monomolecular alternative
si_lundgrendolid1970(
  age = c(20, 40, 60),
  si = c(12, 18, 24),
  species = c("PICE.MAR", "PINU.BAN", "BETU.PAP")
)

# Works with the pipe operator: predict site index from age + height
trees_h <- tibble::tibble(
  species = c("PICE.MAR", "LARI.LAR", "BETU.PAP"),
  age = c(25, 45, 65),
  height = c(9, 18, 23)
)

trees_h |>
  dplyr::mutate(
    si_pred = si_lundgrendolid1970(
      age = age,
      height = height,
      species = species
    )
  ) |>
  tidyr::unnest(si_pred)

# With pipe: predict height from age + site index (monomolecular form)
trees_si <- tibble::tibble(
  species = c("PICE.MAR", "LARI.LAR", "BETU.PAP"),
  age = c(25, 45, 65),
  si = c(14, 20, 22)
)

trees_si |>
  dplyr::mutate(
    height_pred = si_lundgrendolid1970(
      age = age,
      si = si,
      species = species
    )
  ) |>
  tidyr::unnest(height_pred)

}
\references{
Lundgren, Allen L.; Dolid, William A. 1970. Biological growth functions describe published site index curves for Lake States timber species. Research Paper NC-36. St. Paul, MN: U.S. Dept. of Agriculture, Forest Service, North Central Forest Experiment Station
}
